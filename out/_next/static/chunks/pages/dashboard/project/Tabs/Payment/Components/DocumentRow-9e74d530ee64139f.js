(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1341],{76890:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/project/Tabs/Payment/Components/DocumentRow",function(){return n(30313)}])},30313:function(e,t,n){"use strict";n.r(t);var r=n(47568),a=n(14924),o=n(26042),s=n(69396),i=n(828),c=n(29815),u=n(97582),l=n(85893),d=n(4749),f=n(26183),h=n(89448),m=n(29792),p=n(50319),v=n(8987),g=n(2734),y=n(87357),Z=n(11057),b=n(50135),x=n(15861),_=n(53816),j=n(53252),w=n(67294),C=n(86501);t.default=function(e){var t=e.data,n=e.documents,E=void 0===n?[]:n,D=e.user,P=e.rowNo,k=e.projectTitle,T=e.hideAdditionalDocuments,A=(0,g.Z)(),R=(0,w.useState)([]),L=R[0],S=R[1],O=(0,w.useState)([]),N=O[0],V=O[1],U=(0,w.useState)(P),B=U[0],I=U[1],X=(0,i.Z)((0,p.D)(d.Is),1)[0],F=(0,i.Z)((0,p.D)(d.yW),1)[0],J=(0,w.useState)(k),W=J[0],q=(J[1],(0,w.useState)(["","","",""])),G=q[0],K=q[1],M=(0,w.useState)(!1),z=M[0],H=M[1],Q=(0,w.useState)([]),Y=Q[0],$=(Q[1],(0,f.T)());(0,w.useEffect)((function(){I(P)}),[P]),(0,w.useEffect)((function(){var e=[],n=[],r=!0,a=!1,o=void 0;try{for(var s,i=E[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var c=s.value;e.push(c.url),n.push(c.referralAgencyCode)}}catch(l){a=!0,o=l}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}S(e);var u=["","","",""];K(u),t.config.items.map((function(e){D.documents.map((function(t){var n=W.toLowerCase()+"_"+e.id;t.title===n&&(u[parseInt(n[n.length-1])-1]=t.referralAgencyCode||"")}))})),K(u)}),[E,D]);var ee=function(){var e=(0,r.Z)((function(e,t,n){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return[4,X({variables:{title:e,url:t,referralAgencyCode:n}})];case 1:return[2,r.sent()]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),te=function(){var e=(0,r.Z)((function(e,t,n,r){return(0,u.__generator)(this,(function(a){switch(a.label){case 0:return[4,F({variables:{id:e,title:t,url:n,referralAgencyCode:r}})];case 1:return[2,a.sent()]}}))}));return function(t,n,r,a){return e.apply(this,arguments)}}(),ne=function(e,t,n){var r,a=D,i=[];return null===D||void 0===D||null===(r=D.documents)||void 0===r||r.map((function(n){n.id===e?i.push((0,s.Z)((0,o.Z)({},n),{title:"avatar"})):n.title!==t&&i.push(n)})),(0,s.Z)((0,o.Z)({},a),{documents:i})},re=function(e){var t=!1;return null===Y||void 0===Y||Y.map((function(n){e===n.id&&(t=n.status)})),t},ae=function(){var e=(0,r.Z)((function(){var e,n,r;return(0,u.__generator)(this,(function(a){switch(a.label){case 0:H(!0),a.label=1;case 1:a.trys.push([1,6,,7]),e=function(e){var n,r,a,s,i,l,d,f,p;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return N[e]?(n=k+"_"+t.config.items[e].id,[4,(0,m.Z)(L[e])]):[3,7];case 1:return r=u.sent(),a=G[e],s=E.find((function(e){if(e.title.toLowerCase()===n.toLowerCase())return!0})),(i=null===D||void 0===D?void 0:D.documents)||(i=[]),s?[4,te(s.id,n.toLowerCase(),r,a)]:[3,4];case 2:return l=u.sent(),[4,$((0,h.j2)(ne(s.id,n)))];case 3:return u.sent(),C.ZP.success("".concat(n," Uploaded")),(d=i.filter((function(e){return e.id!==document.id}))).push(l.data.updateDocument),i=d,[3,6];case 4:return[4,ee(n.toLowerCase(),r,a)];case 5:f=u.sent(),console.log("resp",f),C.ZP.success("".concat(n," Uploaded")),i=(0,c.Z)(i).concat([f.data.createDocument]),u.label=6;case 6:(p=(0,o.Z)({},D)).documents=i,$((0,h.j2)(p)),u.label=7;case 7:return[2]}}))},n=0,a.label=2;case 2:return n<B?[5,(0,u.__values)(e(n))]:[3,5];case 3:a.sent(),a.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:return r=a.sent(),console.log("error",r),[3,7];case 7:return H(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(_.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,l.jsx)(j.Z,{sx:(0,a.Z)({display:"flex",flexDirection:"column",border:"none"},A.breakpoints.down("sm"),{paddingRight:0}),children:function(){for(var e=[],n=(t.config.items,0);n<B;n++){var r=L[n];r&&e.push((0,l.jsx)("div",{style:{marginTop:15},children:(0,l.jsx)("img",{src:"object"==typeof r?URL.createObjectURL(r):r,height:150,style:{marginLeft:"5px"}})}))}return 0==e.length?(0,l.jsx)(x.Z,{variant:"subtitle1",children:"No Document"}):e}()}),(0,l.jsx)(j.Z,{style:{border:"none"},children:function(){for(var e=function(e){var t,o,s,i,u,d=(0,c.Z)(G);n.push((0,l.jsxs)(y.Z,{sx:(0,a.Z)({height:160,marginTop:1,marginLeft:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start"},A.breakpoints.down("sm"),{marginLeft:0,marginTop:2}),children:[(0,l.jsxs)(y.Z,{sx:(0,a.Z)({marginBottom:"10px",marginLeft:"15px"},A.breakpoints.down("sm"),{marginBottom:"0px"}),children:["Status:"," ",(0,l.jsx)("span",{style:{color:"APPROVED"===re(null===(t=E[e])||void 0===t?void 0:t.id)?"green":"REJECTED"===re(null===(o=E[e])||void 0===o?void 0:o.id)?"red":E[e]?"APPROVED"===E[e].status?"green":"REJECTED"===E[e].status&&"red":""},children:re(null===(s=E[e])||void 0===s?void 0:s.id)||(null===(i=E[e])||void 0===i?void 0:i.status)||"NOT STARTED"})]}),(0,l.jsxs)(Z.Z,{style:{cursor:E[e]&&"APPROVED"===E[e].status?"not-allowed":"pointer",marginTop:"10px"},component:"label",color:E[e]&&"APPROVED"===E[e].status?"secondary":"primary",children:["Choose ",null===(u=r[e])||void 0===u?void 0:u.name,(0,l.jsx)("input",{type:"file",accept:"image/*",hidden:!0,disabled:!!E[e]&&"APPROVED"===E[e].status,onChange:function(t){if(t.target.files.length>0){var n=(0,c.Z)(L);n[e]=t.target.files[0],S(n);var r=(0,c.Z)(N);r[e]=!0,V(r)}}})]}),!D.isKycAgent&&(0,l.jsx)(b.Z,{required:!0,id:"outlined",label:"Secondary Promoter",disabled:!!E[e]&&"APPROVED"===E[e].status,fullWidth:!0,value:G[e],variant:"outlined",onChange:function(t){t.target.value?d[e]=t.target.value:d[e]=null,K(d)}})]}))},n=[],r=t.config.items,o=0;o<B;o++)e(o);return n}()})]}),(0,l.jsxs)("div",{style:{marginBottom:40},children:[B<=10&&(0,l.jsx)(v.Z,{variant:"contained",disabled:L.length!==B,onClick:function(){I(B+1)},children:"Add More"}),(0,l.jsx)(v.Z,{sx:{marginLeft:1},variant:"contained",onClick:T,children:"Go Back"}),(0,l.jsx)(v.Z,{sx:{marginLeft:1},loading:z,variant:"contained",onClick:function(){ae()},children:"Upload"})]})]})}},29792:function(e,t,n){"use strict";var r=n(47568),a=n(97582),o=n(5121),s=function(){var e=(0,r.Z)((function(e){var t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:(t=new FormData).append("document",e),console.log("img",e,"form",t),r.label=1;case 1:return r.trys.push([1,3,,4]),console.log("NEXR","https://kycramaerabackend.ramaera.com"),[4,o.Z.post("".concat("https://kycramaerabackend.ramaera.com","/documents/upload"),t,{headers:{"Content-Type":"multipart/form-data"}})];case 2:return[2,r.sent().data.url];case 3:return n=r.sent(),console.log(n),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();t.Z=s}},function(e){e.O(0,[8244,9990,9260,9213,6827,4753,6549,7058,788,8584,8764,9581,6053,9774,2888,179],(function(){return t=76890,e(e.s=t);var t}));var t=e.O();_N_E=t}]);