"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7471],{77471:function(e,t,n){n.r(t),n.d(t,{rows:function(){return V}});var r=n(34051),a=n.n(r),i=n(85893),u=n(50319),o=n(87357),c=n(86886),s=n(50135),l=n(11057),d=n(15861),f=n(53816),p=n(53252),h=n(94054),m=n(47312),v=n(80788),x=n(30431),y=n(67294),j=n(77502),b=n(42480),g=n(99099),P=n(61636),Z=n(85109),w=n(55511),k=n(8987),E=n(86501),S=n(71455),D=n(9473),C=n(17677);function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t,n,r,a,i,u){try{var o=e[i](u),c=o.value}catch(s){return void n(s)}o.done?t(c):Promise.resolve(c).then(r,a)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function u(e){R(i,r,a,u,o,"next",e)}function o(e){R(i,r,a,u,o,"throw",e)}u(void 0)}))}}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){U(e,t,n[t])}))}return e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],u=!0,o=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);u=!0);}catch(c){o=!0,a=c}finally{try{u||null==n.return||n.return()}finally{if(o)throw a}}return i}}(e,t)||L(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){if(e){if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}var V=[{config:b.Z.project_payment}],F=function(e){var t=e.data,n=e.documents,r=void 0===n?[]:n,h=e.user,m=e.rowNo,v=e.getProjectName,x=e.isPaymentDocument,b=(0,y.useState)(v),g=b[0],P=b[1],Z=(0,y.useState)([]),D=Z[0],O=Z[1],R=(0,y.useState)([]),U=R[0],L=R[1],V=(0,y.useState)(0),F=V[0],_=V[1],H=(0,y.useState)([]),W=H[0],J=H[1],B=(0,y.useState)(["","","",""]),M=B[0],$=B[1],q=(0,y.useState)([null,null,null,null]),z=q[0],G=q[1];(0,y.useEffect)((function(){_(m),P(v)}),[m,v]);var K=T((0,u.D)(j.p1),1)[0],Q=T((0,u.D)(j.HF),1)[0],X=(0,y.useState)(!1),Y=X[0],ee=X[1];(0,y.useEffect)((function(){var e=[],n=!0,a=!1,i=void 0;try{for(var u,o=r[Symbol.iterator]();!(n=(u=o.next()).done);n=!0){var c=u.value;e.push(c.url)}}catch(d){a=!0,i=d}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}O(e);var s=[null,null,null,null],l=["","","",""];$(l),G(s),t.config.items.map((function(e){h.documents.map((function(t){t.title===g+e.id&&(s[parseInt(t.title.slice(16+g.length,17+g.length))-1]=t.amount||"",l[parseInt(t.title.slice(16+g.length,17+g.length))-1]=t.utrNo||"")}))})),$(l),G(s)}),[r,h,g]);var te=function(){var e=A(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=A(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({variables:{id:h.id,documentId:t,url:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=A(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<F)){e.next=9;break}if(!z[t]){e.next=6;break}return e.next=5,K({variables:{id:h.id,documentId:r[t].id,amount:z[t],utrNo:M[t]}});case 5:E.ZP.success("Details Updated");case 6:t++,e.next=1;break;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=A(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q({variables:{id:t,status:n}});case 3:e.sent&&("APPROVED"===n?E.ZP.success("Document Status ".concat(n)):E.ZP.error("Document Status ".concat(n)),J((function(e){return N(e).concat([{id:t,status:n}])}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),E.ZP.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),ie=function(e){var t=null;return null===W||void 0===W||W.map((function(n){e===n.id&&(t=n.status)})),t},ue=function(){var e=A(a().mark((function e(){var n,i,u,o,c,s,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ee(!0),e.prev=1,n=0;case 3:if(!(n<F)){e.next=32;break}if(!U[n]){e.next=29;break}return i=t.config.items[n].id,e.next=8,(0,w.Z)(D[n]);case 8:if(u=e.sent,o=r.find((function(e){if(e.title.toLowerCase()===i.toLowerCase())return!0})),(c=h.documents)||(c=[]),!o){e.next=22;break}return e.next=15,ne(o.id,u);case 15:s=e.sent,E.ZP.success("".concat(i," Uploaded")),(l=c.filter((function(e){return e.id}))).push(s.data.updateDocument),c=l,e.next=27;break;case 22:return e.next=24,te();case 24:d=e.sent,E.ZP.success("".concat(i," Uploaded")),c=N(c).concat([d.data.createDocument]);case 27:I({},h).documents=c;case 29:n++,e.next=3;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(1),console.log("error",e.t0);case 37:ee(!1);case 38:case"end":return e.stop()}}),e,null,[[1,34]])})));return function(){return e.apply(this,arguments)}}();return x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(d.Z,{sx:{fontWeight:"bold",marginTop:5},children:[t.config.name," ",t.isOptional?"(Optional)":""]}),(0,i.jsxs)(f.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,i.jsx)(p.Z,{width:300,children:function(){for(var e=[],t=0;t<F;t++){var n=D[t];n&&e.push((0,i.jsx)("div",{style:{marginTop:15},children:(0,i.jsx)(S.TV,{children:(0,i.jsx)(S.HI,{src:"object"==typeof n?URL.createObjectURL(n):n,children:(0,i.jsx)("img",{src:"object"==typeof n?URL.createObjectURL(n):n,height:150,style:{marginLeft:"5px"}})})})}))}return 0==e.length?(0,i.jsx)(d.Z,{variant:"subtitle1",children:"No Document"}):e}()}),h.kyc!==C.Z.status.APPROVED&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{style:{},children:function(){for(var e=function(e){var t,u,d,f,p=N(z),m=N(M);n.push((0,i.jsxs)("div",{style:{height:160,marginTop:10},children:[(0,i.jsxs)("div",{style:{marginBottom:10},children:["Status:"," ",(0,i.jsx)("span",{style:{color:"APPROVED"===ie(null===(t=r[e])||void 0===t?void 0:t.id)?"limegreen":"REJECTED"===ie(null===(u=r[e])||void 0===u?void 0:u.id)?"red":r[e]?"APPROVED"===r[e].status?"limegreen":"REJECTED"===r[e].status&&"red":""},children:ie(null===(d=r[e])||void 0===d?void 0:d.id)||(null===(f=r[e])||void 0===f?void 0:f.status)})]}),(0,i.jsx)(o.Z,{sx:{display:"flex",justifyContent:"center",marginBottom:"10px"},children:h.kyc!==C.Z.status.APPROVED&&(0,i.jsxs)(c.ZP,{children:[(0,i.jsx)(s.Z,{sx:{width:120},id:"outlined",label:"UTR No.*",value:M[e],variant:"outlined",type:"number",onChange:function(t){t.target.value?m[e]=t.target.value:m[e]=null,$(m)}}),(0,i.jsx)(s.Z,{sx:{width:120,ml:2},id:"outlined",label:"Amount*",value:z[e],variant:"outlined",type:"number",onChange:function(t){t.target.value?p[e]=parseInt(t.target.value):p[e]=null,G(p)}}),(0,i.jsx)(l.Z,{onClick:function(){return ae(r[e].id,"APPROVED")},variant:"outlined",color:"success",sx:{ml:2},children:"Approve"}),(0,i.jsx)(l.Z,{onClick:function(){return ae(r[e].id,"REJECTED")},variant:"outlined",color:"error",sx:{ml:2},children:"Reject"})]})}),(0,i.jsxs)(l.Z,{fullWidth:!0,style:{marginTop:"10px"},component:"label",children:["Choose ",a[e].name,(0,i.jsx)("input",{type:"file",accept:"image/*",hidden:!0,onChange:function(t){if(t.target.files.length>0){var n=N(D);n[e]=t.target.files[0],O(n);var r=N(U);r[e]=!0,L(r)}}})]})]}))},n=[],a=t.config.items,u=0;u<F;u++)e(u);return n}()}),(0,i.jsx)(p.Z,{children:(0,i.jsx)(k.Z,{loading:Y,variant:"contained",onClick:function(){ue(),re()},children:"Update"})})]})]},t.config.name)]}):(0,i.jsxs)(i.Fragment,{children:[(null===h||void 0===h?void 0:h.name)?h.name+" is ":h.rm_id+" is ","not Enrolled in this Project"]})};t.default=function(e){var t=e.to,n=(0,D.I0)(),r=(0,D.v9)((function(e){return e.foundUser.foundUser})),f=(0,D.v9)((function(e){return e.allUsers.allTheUsers})),p=(0,y.useState)(0),b=p[0],k=p[1],O=(0,y.useState)("hajipur_"),R=O[0],U=O[1],N=(0,y.useState)(""),L=N[0],_=N[1],H=(0,y.useState)(),W=H[0],J=H[1],B=(0,y.useState)(),M=B[0],$=B[1],q=(0,y.useState)(),z=q[0],G=q[1],K=(0,y.useState)(!1),Q=K[0],X=K[1],Y=(0,y.useState)(!1),ee=Y[0],te=Y[1],ne=T((0,u.D)(j.p1),1)[0],re=T((0,u.D)(j.HF),1)[0],ae=function(e){var t=(0,D.v9)((function(e){return e.foundUser.foundUser})),n=[];if(t&&t.documents){var r=!0,a=!1,i=void 0;try{for(var u,o=function(e,r){var a=r.value,i=t.documents.find((function(e){if(e.title.toLowerCase()===R+a.id.toLowerCase())return!0}));i&&n.push(i)},c=e[Symbol.iterator]();!(r=(u=c.next()).done);r=!0)o(0,u)}catch(s){a=!0,i=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}}return n},ie=function(){var e=A(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r.documents.map((function(e){e.title.slice(0,16+R.length)===R+V[0].config.items[0].id.slice(0,-1)&&(t+=1)})),k(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,y.useEffect)((function(){ie()}),[R]);var ue=function(e,t){var n=r,a=[];return r.documents.map((function(n){n.id===e?a.push(I({},n,{url:t})):a.push(n)})),I({},n,{documents:a})},oe=function(e,t,n){var a=r,i=[];return r.documents.map((function(r){r.id===e?i.push(I({},r,{amount:t,urtNo:n})):i.push(r)})),I({},a,{documents:i})},ce=function(e,t){var n=r,a=[];return r.documents.map((function(n){n.id===e?a.push(I({},n,{status:t})):a.push(n)})),I({},n,{documents:a})},se=function(){var e=A(a().mark((function e(t,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re({variables:{id:t,status:r}});case 2:n((0,P.Hn)(ce(z.id,r))),n((0,g.UF)((0,Z.Z)(f,ce(z.id,r))));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=A(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ne({variables:{id:r.id,documentId:z.id,amount:parseInt(W),utrNo:M}});case 3:n((0,P.Hn)(oe(z.id,parseInt(W),M))),n((0,g.UF)((0,Z.Z)(f,oe(z.id,parseInt(W),M)))),E.ZP.success("Details Updated"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),E.ZP.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=A(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t="",!Q){e.next=14;break}return e.prev=3,e.next=6,(0,w.Z)(L);case 6:t=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),E.ZP.error("Error, Try Again!");case 12:e.next=15;break;case 14:t=L;case 15:if(!z){e.next=22;break}return e.next=18,ne({variables:{id:r.id,documentId:z.id,url:t}});case 18:n((0,P.Hn)(ue(z.id,t))),n((0,g.UF)((0,Z.Z)(f,ue(z.id,t)))),e.next=23;break;case 22:case 23:E.ZP.success("Payment Slip Updated "),e.next=29;break;case 26:e.prev=26,e.t1=e.catch(0),E.ZP.error(e.t1);case 29:case"end":return e.stop()}}),e,null,[[0,26],[3,9]])})));return function(){return e.apply(this,arguments)}}();(0,y.useEffect)((function(){G(null),_(null),J(null),$(null),r&&r.documents&&r.documents.length>0&&r.documents.find((function(e){e.title.toLowerCase()===R+V[0].config.id&&(G(e),e.url?_(e.url):_(""),e.amount?J(e.amount):J(""),e.utrNo?$(e.utrNo):$(""))}))}),[r,R]);return(0,y.useEffect)((function(){t&&U(t+"_")}),[t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z,{width:150,children:(0,i.jsxs)(h.Z,{variant:"outlined",fullWidth:!0,children:[(0,i.jsx)(m.Z,{children:"Project"}),(0,i.jsx)(v.Z,{value:R,onChange:function(e){return U(e.target.value)},label:"Project",autoWidth:!0,children:[{id:"hajipur_",name:"Hajipur"},{id:"agra_",name:"Agra"}].map((function(e){return(0,i.jsx)(x.Z,{value:e.id,children:e.name},e.id)}))})]})}),L?(0,i.jsx)(S.TV,{children:(0,i.jsx)(S.HI,{src:"object"==typeof L?URL.createObjectURL(L):L,children:(0,i.jsx)("img",{style:{marginTop:"10px",cursor:"pointer"},src:"object"==typeof L?URL.createObjectURL(L):L,width:200})})}):null,z&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(d.Z,{variant:"h4",sx:{my:2},children:["Status :"," ",(0,i.jsx)("span",{style:{color:z?"APPROVED"===z.status?"limegreen":"REJECTED"===z.status&&"red":""},children:z&&z.status})]}),(0,i.jsx)(o.Z,{children:r.kyc!==C.Z.status.APPROVED&&(0,i.jsxs)(c.ZP,{children:[(0,i.jsx)(l.Z,{onClick:function(){return se(z.id,"APPROVED")},variant:"outlined",color:"success",children:"Approve"}),(0,i.jsx)(l.Z,{onClick:function(){return se(z.id,"REJECTED")},variant:"outlined",color:"error",sx:{ml:2},children:"Reject"})]})})]}),L&&r.kyc!==C.Z.status.APPROVED&&(0,i.jsxs)(c.ZP,{container:!0,p:2,mt:2,ml:0,pl:0,gap:2,spacing:2,children:[(0,i.jsx)(s.Z,{id:"outlined",label:"UTR No.*",value:M,variant:"outlined",type:"number",onChange:function(e){$(e.target.value)}}),(0,i.jsx)(s.Z,{id:"outlined",label:"Amount*",value:W,variant:"outlined",type:"number",onChange:function(e){J(e.target.value)}}),(0,i.jsx)(c.ZP,{children:(0,i.jsx)(l.Z,{fullWidth:!0,disabled:!W&&!M,variant:"contained",component:"label",onClick:function(){le()},sx:{padding:"14px"},children:"Submit"})})]}),(0,i.jsxs)(c.ZP,{container:!0,p:2,pl:0,spacing:2,children:[z&&r.kyc!==C.Z.status.APPROVED&&(0,i.jsx)(c.ZP,{item:!0,xs:12,sm:4,children:(0,i.jsxs)(l.Z,{variant:"contained",component:"label",children:["Select Payment Slip",(0,i.jsx)("input",{type:"file",accept:"image/*",hidden:!0,onChange:function(e){e.target.files.length>0&&(te(!0),_(e.target.files[0]),X(!0))}})]})}),z&&r.kyc!==C.Z.status.APPROVED&&(0,i.jsx)(c.ZP,{item:!0,xs:2,children:(0,i.jsx)(l.Z,{fullWidth:!0,variant:"contained",disabled:!ee,onClick:function(){de()},children:"Submit"})}),(0,i.jsx)(E.x7,{position:"bottom-center",reverseOrder:!1})]}),(0,i.jsx)(i.Fragment,{children:V.map((function(e,t){return(0,i.jsx)(F,{data:e,rowNo:b,isPaymentDocument:z,user:r,getProjectName:R,documents:ae(e.config.items)},t)}))})]})}}}]);